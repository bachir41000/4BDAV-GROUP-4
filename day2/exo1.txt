1-compter le nombre total des enregistrements dans chaque table du schéma HR

DECLARE
    nbLignes INTEGER;
BEGIN
 
    FOR C1 IN (
        select table_name
        from user_tables 
    ) LOOP

<<<<<<< HEAD
    EXECUTE IMMEDIATE 'SELECT count(*) FROM ' || i.table_name INTO nbLignes;

    DBMS_OUTPUT.PUT_LINE( C1.table_name || ' : ' || nbLignes );
=======
    EXECUTE IMMEDIATE 'SELECT count() FROM '  i.table_name INTO nbLignes;

    DBMS_OUTPUT.PUT_LINE( C1.table_name  ' : ' || nbLignes );
>>>>>>> d09ea3ac003820a010a4481c884b1b64916ed310

    END LOOP;
END;


2-compter le nombre d’employés dont la fonction (JOB) est MANAGER dans la table EMPLOYEE

DECLARE
    nbLignes INTEGER;
BEGIN
 
<<<<<<< HEAD
    Select count(*) into total_manager
    from employees inner join jobs
    on employees.job_id = jobs.job_id
    where jobs.job_title like '%Manager%';

    DBMS_OUTPUT.PUT_LINE(' Nombre d employes dont la fonction JOB est MANAGER ': ' || nbLignes);

END;

En output on a 12 employées qui sont manager.
=======
    Select count() into total_manager
    from employees inner join jobs
    on employees.job_id = jobs.job_id
    where jobs.job_title like '%Manager%';

    DBMS_OUTPUT.PUT_LINE(' Nombre d employes dont la fonction JOB est MANAGER ': '  nbLignes);

END;

En output on a 12 employées qui sont manager.

3-calculer la proportion (en pourcentage) de managers

DECLARE
     pourcentage INTEGER;
BEGIN
    SELECT ROUND(total_manager / (SELECT COUNT() FROM EMPLOYEES),4) 100 INTO pourcentage
    FROM ( SELECT count(*) AS total_manager
            FROM EMPLOYEES
            INNER JOIN JOBS
            ON employees.job_id = jobs.job_id
            WHERE JOBS.JOB_TITLE like '%Manager%'
        );

    DBMS_OUTPUT.PUT_LINE ('Pourcentage de manager : '  pourcentage || ' %');
END; 

Nous avons 13% de managers

>>>>>>> d09ea3ac003820a010a4481c884b1b64916ed310

3-calculer la proportion (en pourcentage) de managers

DECLARE
     pourcentage INTEGER;
BEGIN
    SELECT ROUND(total_manager / (SELECT COUNT(*) FROM EMPLOYEES),4) * 100 INTO pourcentage
    FROM ( SELECT count(*) AS total_manager
            FROM EMPLOYEES
            INNER JOIN JOBS
            ON employees.job_id = jobs.job_id
            WHERE JOBS.JOB_TITLE like '%Manager%'
        );
    
    DBMS_OUTPUT.PUT_LINE ('Pourcentage de manager : ' || pourcentage || ' %');
END; 

Nous avons 13% de managers





























